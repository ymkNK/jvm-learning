# 2021-04-26 JVM是如何实现反射的 HowJvmReflect

## 反射调用的实现
### 委派实现作为中间层最终调用本地实现
MethodAccessor
- 本地实现
- 委派实现

先给委派实现,再交给本地实现。
### 动态实现
其实，Java 的反射调用机制还设立了另一种动态生成字节码的实现（下称动态实现），直接使用 invoke 指令来调用目标方法。之所以采用委派实现，便是为了能够在本地实现以及动态实现中切换。
动态实现速度比本地实现速度快20倍。

考虑到许多反射调用仅会执行一次，Java 虚拟机设置了一个阈值 15（可以通过 -Dsun.reflect.inflationThreshold= 来调整），当某个反射调用的调用次数在 15 之下时，采用本地实现；当达到 15 时，便开始动态生成字节码，并将委派实现的委派对象切换至动态实现，这个过程我们称之为 Inflation。